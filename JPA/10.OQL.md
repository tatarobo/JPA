# 10. 객체지향 쿼리 언어
## Intro
- 객체지향 쿼리 소개
- JPQL
	- 가장 중요한 객체지향 쿼리 언어
- Criteria
- QueryDSL
- 네이티브 SQL
- 객체지향 쿼리 심화
## 객체지향 쿼리 소개
- 객체 조회 방법
	- 식별자로 조회 (EntityManager.find())
	- 객체 그래프 탐색 (ex - a.getB().getC())
- JPQL 특징
	- 테이블이 아닌 **객체를 대상으로 검색**하는 객체지향 쿼리
	- **SQL을 추상화해서 특정 DB SQL에 의존하지 않음**
- JPA가 공식적으로 지원하는 기능들
	- JPQL (Java Persistence Query Language)
	- Criteria 쿼리 
		- JPQL을 편하게 작성하도록 도와주는 API
		- 빌더 클래스 모음
	- 네이티브 SQL
		- JPA에서 JPQL 대신 직접 SQL을 사용할 수 있음
- JPA에서 공식적으로 지원하진 않지만 알아둘 가치가 있는 기능들
	- QueryDSL
		- Criteria 같은 빌더 클래스 모음
		- 비표준 오픈소스 프레임워크
	- JDBC 직접 사용, MyBatis 같은 SQL 매퍼 프레임워크
### 10.1.1 JPQL 소개
- 정의 : 엔티티 객체를 조회하는 객체지향 쿼리
- 특징
	- SQL을 추상화해서 특정 DB에 의존하지 않음
		- DB dialect (방언) 만 변경하면 JPQL을 수정하지 않아도 DB 변경 가능
		- ex) DB 마다 문법이 다른 거라도 dialect 에 따라 맞춘 쿼리가 실행됨
	- 문법이 SQL과 비슷
	- ANSI 표준 SQL이 제공하는 기능을 유사하게 지원
	- SQL보다 간결함
		- 엔티티 직접 조회, 묵시적 조인, 다형성 지원
- ex)
	```
	@Entity(name="Member")
	public class Member {
		@Column(name = "name")
		private String username;
	}
	```
- JPQL 사용
	```
	// 쿼리 생성
	String jpql = "select m from Member as m where m.username = 'kim'";
	List<Member> resultList = em.createQuery(jpql, Member.class).getResultList();
	```
	- m.username 은 테이블 컬럼명이 아니라 엔티티 객체의 필드명
	- em.createQuery()에 
		- 실행할 JPQL
		- 반환할 엔티티의 클래스 타입인 Member.class를 넘겨줌
		- getResultList() 메소드를 실행 
		- JPA는 JPQL을 SQL로 변환해서 DB를 조회
		- 조회 결과로 Member.class 엔티티 생성해서 반환
	- 실제 실행된 SQL
	```
	select
		member.id as id,
		member.age as age,
		member.team_id as team,
		membebr.name as name
	from
		Member member
	where
		member.name='kim'
	```
		- 실제로는 좀 더 복잡해서 위는 단순화시킨 버전임
### 10.1.2 Criteria 쿼리 소개
- 정의 : **JPQL을 생성하는 빌더 클래스**
- 장점
	- 프로그래밍 코드로 JPQL을 작성할 수 있다는 것 (컴파일 시에 오류 발견 가능)
		- ex) query.select(m).where(...)
	- IDE를 사용하면 코드 자동완성을 지원
	- 동적 쿼리를 작성하기 편함
- 문자 기반 쿼리의 단점
	- 런타임 시점까지 오타를 잡지 못함
	- ex) select m from Membeeee m 처럼 오타가 있어도 컴파일 시에는 잡지 못함
- 
<!--stackedit_data:
eyJoaXN0b3J5IjpbLTIxMjk5NjYzMCw3MzA5OTgxMTZdfQ==
-->