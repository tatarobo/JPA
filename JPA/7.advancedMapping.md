
# 7. 고급 매핑 개요

* 상속관계 맵핑
	* 객체의 상속 관계를 DB에서 어떻게 매핑할지?
* @MappedSuperclass
	* 등록일, 수정일 등 여러 Entity에서 공통으로 사용하는 매핑 정보만 상속받기
* 복합 키와 식별관계 맵핑
	* DB 식별자가 하나 이상일 때
	* 식별관계 - 비식별관계
* 조인 테이블
	* 연관관계를 외래키로 관리하는 방법
	* 연관관계를 관리하는 연결 테이블을 두는 방법
* 엔티니 하나에 여러 테이블 맵핑하기
	* 말 그대로...

# 7.1 상속관계 맵핑

* RDB에는 상속 개념 없음.
* SuperType SubType Relationship 모델링 기법
	* 객체의 상속 개념과 가장 유사하다.
* 객체 상속 구조와 DB의 STSTR 관계를 맵핑
```
      물품
       |
 |-----|-----|
 |     |     |
음반   영화    책
```
### 논리 모델을 물리 모델인 테이블로 구현하는 3가지 방법
* 각각의 테이블로 변환
	* 각각을 모두 테이블로 만들고 조회할 때 Join을 사용
	* `Join 전략`
* 통합 테이블로 변환
	* 테이블을 하나만 사용해서 통합
	* `단일 테이블 전략`
* 서브타입 테이블로 변환
	* 각각의 서브타입마다 하나의 테이블을 생성
	* `테이블 전략`

### Join 전략
* Item
```java
@Entity
@Inheritance(strategy= InheritanceType.JOINED)
@DiscriminatorColumn(name = "DTYPE")
public abstract class Item {
	@Id @GeneratedValue
	@Column(name="ITEM_ID")
	private Long id;
	private String name;
	private int price;
}
```

* Album
```java
@Entity
@DiscriminatorValue("A")
public abstract class Album extends Item {
	private String artist;
}
```

* Movie
```java
@Entity
@DiscriminatorValue("M")
public abstract class Movie extends Item {
	private String director;
}
```

<!--stackedit_data:
eyJoaXN0b3J5IjpbMTgwNTg2Njc5NSwtMTI3NTYxMDE1NSwtMT
Q2MTEzMjU3OCwtOTA4MTAzNzc3LDU2NTU0ODgxMF19
-->